<!doctype html>
<html lang="en">

<head>
  <script src="https://cdn.socket.io/4.8.0/socket.io.min.js"
    integrity="sha384-OoIbkvzsFFQAG88r+IqMAjyOtYDPGO0cqK5HF5Uosdy/zUEGySeAzytENMDynREd"
    crossorigin="anonymous"></script>
  <script>
    var socket = io('https://gbf.nekorinsoft.com/', {
      path: '/socket'
    });
    document.getElementById("current-room").value = "public";
    function copyURI(value) {
      navigator.clipboard.writeText(value).then(() => {
      }).catch((e) => {
        console.log(e)
      })
    }

    function changeRoom(room) {
      if(!room) {
        room = document.getElementById("room-id").value
      }
      socket.emit("join", room)
      document.getElementById("current-room").value = document.getElementById("room-id").value
      document.getElementById('list').innerHTML = ""
    }

    function clearList() {
      document.getElementById('list').innerHTML = ""
    }

    socket.on("message", (arg) => {
      document.getElementById('list').innerHTML = `<div style="width: 10vw; margin-bottom: 1vh">
      <a onclick="copyURI(this.name)" href="#" name="` + arg.code + `" style="width: 10vw">
          <h3>` + arg.code + " - " + arg.nickname + `</h3>
      </a>
    </div>` + document.getElementById('list').innerHTML
    })

    changeRoom()
  </script>
  <title>Granblue Fantasy Raid Finder</title>
</head>

<body>
  <marquee direction="left">this web is sponsored by no one. please fucking help</marquee>
  <div>
    <div>Current room: <span id="current-room"></span></div>
    <div>
      <input type="text" placeholder="Room ID" id="room-id" style="width: 10vw; margin-bottom: 1vh" />
      <button class="btn btn-neutral" onclick="changeRoom()">Change</button>
      <button onclick="clearList">Clear List</button>
    </div>
  </div>
  <div id="list">
  </div>
</body>

</html>